# 1 Know your enemy[](/book/grokking-web-application-security/chapter-1/)

### In this chapter

- How hackers attack you and why
- How you will be affected if your site gets hacked
- How paranoid you should be
- How to start addressing the risk of being hacked

[](/book/grokking-web-application-security/chapter-1/)Launching a web application on the internet is a daunting task. The steps you take along the road to deploying a web app can be onerous: designing and coding your web pages, adding interactivity using JavaScript, implementing the backend services and connecting them to a data store, choosing a hosting platform, and registering a domain name. The result is worthwhile, of course: your website will be available to billions of users immediately, thanks to the magic of the internet.

Not all these users have good intentions, though. The internet hosts a complex ecosystem of scripts, bots, and hackers who will try to abuse any security flaws in your web app for nefarious ends. This is probably the most disconcerting aspect of web development: after all the work you put into building your web application, someone will immediately come along to kick the tires and scratch the paintwork.

Because you are reading this book, you are likely a developer who is wary of these security risks and who wants to learn how to protect yourself. This book is a comprehensive guide to web security: you will learn how to secure your web apps in the browser, on the network, on the server, and at code level. I will also introduce the key security principles that can be applied at each level of abstraction.

Before we delve into the nuts and bolts, however, it’s worth investigating who these malicious actors on the internet are, what motivates them, and what tools they use. Let’s talk about hackers.

## Figuring out how hackers attack you (and why)

*Hacking* is, in its most literal sense, an attempt to gain unauthorized access to software systems. But this definition doesn’t do justice to the wide variety of miscreants and nuisance-makers who populate the internet, though it encompasses a few gray areas we wouldn’t consider hacking. (Does sharing your Netflix login with a family member make you a hacker? Don’t answer that question, Reed Hastings.)

[](/book/grokking-web-application-security/chapter-1/)Instead, we should switch our scope to consider the hackers themselves—the cybercriminals who will target your web application. These folks have been using the internet to commit crimes for almost as long as the internet has existed. Attackers can be broadly classified as *black hat* hackers, who perform malicious (and illegal) acts for financial or political gain, or *white hat* hackers*,* who attempt to identify vulnerabilities before the black hats can take advantage of them. Large companies often pay so-called *bug bounties* to the latter group, rewarding anybody who can find flaws in their security strategy before the bad actors do. This practice has led to the rise of *gray hat* hackers, who will report a vulnerability rather than exploit it if they deem reporting it to be more profitable.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Hackers on both sides of the divide use automated tools and scripts to detect vulnerabilities. These tools are generally open source and easy to obtain. Many hackers use *Kali Linux*, a custom Linux distribution containing the most popular digital forensic and hacking tools. White hat hackers use Kali as part of their *penetration testing* activities, scanning a client system for vulnerable access points as part of a security audit. Black hats use the same tools to find vulnerabilities they can exploit.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

The white hat world also includes *security researchers* who work to discover, document, and share information about vulnerabilities in common software. A researcher might discover a vulnerability on a popular Java web server such as Apache Tomcat, for example, and then demonstrate to the authors of the software how the vulnerability is exhibited. When a software patch has been made available to resolve the problem, such vulnerabilities are cataloged in the Common Vulnerability and Exposure (CVE) database maintained by MITRE Corporation, an American not-for-profit organization specializing in cybersecurity. You often see such vulnerabilities referred to by CVE numbers.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

As soon as a new CVE is published—and sometimes before—proof-of-concept exploits also become available. *Exploits* are snippets of code that demonstrate how the vulnerability can be used to perform malicious activity, such as smuggling malicious code into a vulnerable system. Such exploits quickly get incorporated into hacking tools such as *Metasploit*, commonly used by both black hat and white hat hackers to probe websites for vulnerabilities. Black hat hackers also hoard knowledge of vulnerabilities they have discovered, trying to keep the vulnerability in place as long as possible so that it doesn’t get patched.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Making use of software vulnerabilities isn’t the only tool in the cybercriminal’s toolkit, either. *Social engineering* is the process of gaining a target’s trust and persuading them to divulge confidential information, such as login credentials. Social engineering can be done in person, over the phone, or via messaging channels. You may be familiar with *phishing* emails that attempt to trick a target into sharing their password. Hackers find a lot of success with *spear phishing*, performing background research to target named people (often in the accounting departments of companies). This form of fraud has a counterpart in messaging apps and social media.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Some of the most audacious cybercrimes of recent years have been assisted by *malicious insiders*—rogue employees or contractors who decide to sell or leak company secrets or intellectual property or to cause other types of harm. Having a bad actor in your organization is one of the most difficult situations to protect against, so companies at risk tend to restrict data access on a need-to-know basis.[](/book/grokking-web-application-security/chapter-1/)

[](/book/grokking-web-application-security/chapter-1/)Why is cybercrime so common? The answer, unsurprisingly, is that it can be quite profitable. An underground economy of sites comprises the *dark web,* where hackers resell stolen data, credit card numbers, vulnerabilities, and even compromised servers. Payments are exchanged via cryptocurrencies, making them very difficult to trace. Because the dark web is available only via the Tor browser, which anonymizes access, these markets operate with impunity and are extremely difficult for law enforcement agencies to disrupt.[](/book/grokking-web-application-security/chapter-1/)

In addition to selling stolen data on the dark web, cybercriminals use extortion to extract money directly from their victims. *Ransomware* is a form of malicious software that encrypts a victim’s files and prevents access to them until a cryptocurrency ransom is paid to the attacker. Businesses as diverse as oil pipelines, healthcare providers, meat suppliers, and hotel chains have all been victims of major attacks and have been forced to pay to get their servers unlocked. Ransomware has become so ubiquitous that the authors of such software operate a franchise model, making their tools freely available to black hat hacker groups in exchange for a cut of each ransom payment. Attackers sometimes even offer “support channels” to victims who need assistance decrypting their file-systems after a ransom is paid.[](/book/grokking-web-application-security/chapter-1/)

It’s worth noting that not all hacking is done for financial reasons. *Hacktivism* describes hacking that’s done for political reasons by provocateurs who want to further their cause. The aims of hacktivists are often laudable, such as bringing down social media sites used by the far right by deanonymizing *(doxing)* their users, disrupting repressive political regimes, or leaking documents from tax havens.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Cyber espionage plays a key role in modern warfare, too, and the most formidable hacker groups are usually state sponsored. Hacking groups that fall into this category use sophisticated surveillance techniques to target their victims. Security researchers trace such *advanced persistent threats* (APTs) by tracking the signature techniques they use. The security community gives each APT a fun code name such as Cozy Bear (a Russian hacking group) or Charming Kitten (an Iranian government cyberwarfare group) that contrasts with the chaos it causes.[](/book/grokking-web-application-security/chapter-1/)

## Surviving the fallout from getting hacked

Now that we’ve met our adversaries, let’s consider what it means to be a victim of a hacker. Just as *hacking* describes a wide range of activities, falling victim to a cyberattack can have a variety of outcomes with differing degrees of severity.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

The most straightforward consequence of getting hacked is that your web app will become unavailable to other, legitimate users. This type of hack is called a *denial-of-service* (DoS) attack. To achieve this end, hacking tools don’t need to penetrate your security perimeter; an attacker can simply bombard your servers with so many requests that no computing resources are available to other visitors.[](/book/grokking-web-application-security/chapter-1/)

Despite their relative lack of sophistication, DoS attacks can be hard to prevent. *Distributed denial-of-service* (DDoS) attacks use thousands of individual servers to send requests simultaneously from different Internet Protocol addresses, making it difficult to block malicious requests based on their sources. In 2016, *Domain Name System* (DNS) provider Dyn fell victim to one of the largest DDoS attacks in history, which led to some of the most popular websites in the world—everything from Amazon.com to Zillow.com—being unavailable in the United States for much of the day.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Another potential consequence of your web application’s getting hacked is that the attacker will use it as a launchpad to target your users. Injecting malicious JavaScript into a website is called *cross-site scripting* (XSS), a common vulnerability we will look at in chapter 6. Malicious JavaScript can cause a nuisance by diverting users to scams and fraud on other sites, or it can be used to observe the victim’s activity on the host site itself. *Keylogging* scripts can capture usernames and passwords as a user logs in. On financial websites, *web-skimming* scripts can be used to steal credit card details.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Stealing credentials is a common aim for hackers because harvested usernames and passwords can be sold on the dark web. Credentials for popular social media sites such as Facebook are purchased by scammers who use them to promote their scams. (No, your uncle is not selling discount sunglasses; his account has probably been hacked and resold.) Stolen credentials have a secondary use: because people tend to reuse usernames and passwords across websites, a hacker can retest stolen credentials against a host of different websites in *password-spraying* attacks. Alternatively, an attacker may target a single site, retrying a whole database of stolen passwords at one time in a *credential-**stuffing* attack.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

The quickest way for an attacker to steal credentials in bulk is to find a way to access and download the contents of your database. Such *data breaches* are often the worst-case scenario for many companies because data is their key asset. Usernames and passwords are not the only sensitive data stored in databases; hackers can scoop up access tokens for third-party services, chat logs, trade secrets, personally identifiable information, and credit card numbers. In many countries, companies that suffer data breaches are legally obliged to disclose the scope of the breach to customers, which will cause them reputational damage.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

An attacker who can gain *write* *access* to a victim’s database gains the ability to expand the reach of their attack. They may be able to inject into the database some malicious JavaScript that will be rendered on the pages of the victim’s website. Or they might insert malicious files (such as ransomware) that the users of the site will be tricked into downloading.[](/book/grokking-web-application-security/chapter-1/)

Hackers who have gained a foothold in your system will try to *escalate their privileges* until they acquire full access to your servers. The tools they use for this purpose are called *rootkits;* hackers try to gain access to your server’s root account, which holds the most privileges. A hacker who has achieved root access can start using your computing resources for their own purposes. Making the server part of a *botnet*—a centrally controlled network of compromised computers called *bots*—will allow them to mine cryptocurrency, send phishing emails, commit click fraud (by using bots to artificially inflate page views), and carry out many other profitable activities. Access to compromised servers can be resold on the dark web, so your computing resources may be resold without your knowledge.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Detecting compromised servers is a challenging proposition even for security firms that do that work professionally. Generally, detection requires scanning for unusual activity on the network, searching for suspicious files on the filesystem, or detecting unexplained spikes in resource use. To complicate matters even further, modern hacker groups try to practice *living off the land,* mimicking existing processes and using only locally accessible services to avoid detection.

## Determining how paranoid you should be

Hackers are real-life active threats, and the results of their hacking efforts can be catastrophic. Companies that get hacked face reputational and financial damage. Who wants to use a service that leaks your information, after all? Additionally, a data breach can have legal repercussions if the victim can be shown not to have taken due care when securing their systems. Cyberattacks have driven many companies into bankruptcy.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Before you panic, however, take a step back and assess realistically how much of a threat hackers pose to your organization. Considering who would want to attack you and what they might seek to do is called *threat modeling*.

How much of a threat hackers pose depends on how large a target you are and on what hackers might gain by compromising your systems. Government organizations, energy providers, and financial services are high-profile targets. Any industry that stores confidential information—such as healthcare or education—is high risk, too. The size of your organization is also a factor; gaining access to the network of a large company (called *big-game hunting*) is much more lucrative for a hacker.[](/book/grokking-web-application-security/chapter-1/)

If you work for an organization in any of these industries, your employer most likely has an in-house security team that will audit systems and monitor for suspicious access. This team will carry some of the burden of considering security risks, allowing you to concentrate on writing secure code. (If you are ever called into a secret meeting to discuss a *priority zero (P0) event*, know that your company’s security team has applied a standard threat-modeling matrix and has deemed something to be a critical threat.)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Hackers are opportunistic, however, and will use tools to trawl the internet for web servers with known vulnerabilities, whoever you work for. This type of drive-by vulnerability scanning is something that you, as a developer, should be worried about. You should also look for any existing flaws in your codebase that can be exploited, such as broken authentication functions or lack of access control. Taking precautions such as fixing the most obvious vulnerabilities in your code and making yourself a hard target often causes hackers to move on to easier prey.

## Knowing where to start protecting yourself

This book will be your guide to writing secure code and detecting vulnerabilities in your web applications. Reading the whole thing—or diving into the chapters you find most relevant—will give you a head start on securing your apps. You are probably keen to start your security journey right now, though, so this section presents a few things you can start doing as you delve into the rest of the book.[](/book/grokking-web-application-security/chapter-1/)

### Keep track of new vulnerabilities

*Zero-day* vulnerabilities describe security problems that have just been made public. (In other words, it has been zero days since public disclosure.) Hackers will jump on the opportunity to exploit zero days, so the onus is on your team to keep track of new vulnerabilities and apply security patches as they become available. When a zero day is announced, you are in a race against time.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

Social media and news sites are your friends if you’re looking to keep abreast of security alerts. X and Reddit will keep you in the loop if you follow tech leaders or subscribe to the relevant sub-Reddits. Major vulnerabilities such as Log4Shell, a remote code execution vulnerability in the Java logging library Log4J, make the news on major tech sites, such as TechCrunch and Ars Technica.

### Know what code you are deploying

To keep your web application secure, you need to know what code it is running. It is impossible to know what vulnerable libraries your code is calling—and, hence, what patches you need to apply—unless you know what *dependencies* were deployed during the release process. Chapter 5 talks about how to deploy from source control and use a dependency manager. If you can’t determine at a glance what code is running on your web application, make fixing this situation a priority![](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

### Log and monitor activity

You may never know that you have been a victim of a cyberattack unless you have sufficient information to diagnose it. You should be able to view real-time logs of a web app to observe how it is being accessed. Your code should be catching and reporting unexpected errors that occur. Finally, you should have a monitoring system on each web application so that you can see how many requests it is handling per second and the average response time of your application. Logging, error reporting, and monitoring also help with *forensic analysis—*figuring out after the fact how an attacker managed to compromise your systems.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

### Convert your team members into security expert

The best defense against being hacked is having a whole team on the lookout for security incidents and potential vulnerabilities. Code reviews can catch security problems before they’re released, and having a whole team of well-trained developers cross-checking one another’s work will put you in a strong security stance. Encourage your colleagues to brush up on their security knowledge and to be vocal about potential security problems in team meetings.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

### Slow down

Security problems at the code level often occur when a team is rushing to hit deadlines. Ensure that your development life cycle allows enough time for careful code reviews and analysis, especially if you’re maintaining *legacy code*—code written by someone who has moved on to other companies or projects. It can be hard to juggle security considerations in the face of tight deadlines, but it is certainly less time consuming than dealing with the aftermath of a cyberattack.[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)[](/book/grokking-web-application-security/chapter-1/)

## Summary

-  Hackers will target your web applications for financial gain, notoriety, or political reasons.
-  Hackers employ a variety of tools and sophisticated techniques, and selling stolen data or deploying ransomware can be profitable.
-  If your website is hacked, it may be taken offline, your data stolen, your users targeted, or your servers infected with bots.
-  Your risk profile depends on the size of your company and your industry, but no one is safe from drive-by vulnerability scanning.
-  Keeping track of vulnerabilities, tracking your dependencies, making sure that your system is observable, educating your team about security, and baking security reviews into your development life cycle will lead to immediate benefits.[](/book/grokking-web-application-security/chapter-1/)
